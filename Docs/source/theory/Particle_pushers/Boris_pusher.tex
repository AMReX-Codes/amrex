\input{../newcommands}

The solution proposed by Boris \cite{BorisICNSP70} is given by 
\begin{align}
\mathbf{\bar{v}}^{i}= & \frac{\gamma^{i+1/2}\mathbf{v}^{i+1/2}+\gamma^{i-1/2}\mathbf{v}^{i-1/2}}{2\bar{\gamma}^{i}}.\label{Eq:boris_v}
\end{align}
where $\bar{\gamma}^{i}$ is defined by $\bar{\gamma}^{i} \equiv (\gamma^{i+1/2}+\gamma^{i-1/2} )/2$.

The system (\ref{Eq:leapfrog_v},\ref{Eq:boris_v}) is solved very
efficiently following Boris' method, where the electric field push
is decoupled from the magnetic push. Setting $\mathbf{u}=\gamma\mathbf{v}$, the
velocity is updated using the following sequence:

\begin{subequations}
\begin{align}
\mathbf{u^{-}}= & \mathbf{u}^{i-1/2}+\left(q\Delta t/2m\right)\mathbf{E}^{i}\\
\mathbf{u'}= & \mathbf{u}^{-}+\mathbf{u}^{-}\times\mathbf{t}\\
\mathbf{u}^{+}= & \mathbf{u}^{-}+\mathbf{u'}\times2\mathbf{t}/(1+t^{2})\\
\mathbf{u}^{i+1/2}= & \mathbf{u}^{+}+\left(q\Delta t/2m\right)\mathbf{E}^{i}
\end{align}
\end{subequations}
where $\mathbf{t}=\left(q\Delta
  t/2m\right)\mathbf{B}^{i}/\bar{\gamma}^{i}$ and where
$\bar{\gamma}^{i}$ can be calculated as $\bar{\gamma}^{i}=\sqrt{1+(\mathbf{u}^-/c)^2}$. 

The Boris implementation is second-order accurate, time-reversible and fast. Its implementation is very widespread and used in the vast majority of PIC codes.
